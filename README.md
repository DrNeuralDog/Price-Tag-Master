# Price Tag Master

Приложение для автоматического создания ценников из Excel файлов с данными о товарах.

## Описание

Price Tag Master - это Qt приложение, которое позволяет:
- Загружать данные о товарах из Excel файлов (.xlsx)
- Автоматически создавать красивые ценники в формате OpenDocument (.odt)
- Просматривать данные в удобной таблице
- Анализировать статистику по товарам

## Возможности

### Поддерживаемые поля данных:
- **Поставщик** - название юридического лица или физического лица
- **Адрес** - юридический адрес поставщика
- **Фирма** - название фирмы-производителя
- **Категория** - категория товара (до 17 символов)
- **Пол** - пол для товара (объединяется с категорией если она ≤12 символов)
- **Страна бренда** - страна происхождения бренда
- **Место производства** - страна производства
- **Материал** - состав материала
- **Размер** - размер товара
- **Артикул** - артикул товара
- **Цена** - основная цена товара
- **Цена 2** - цена со скидкой (если указана, показывается перечеркнутой)
- **Количество** - количество ценников для данной позиции товара
- **Прочие данные** - дополнительные данные

### Особенности API:
- **Гибкая структура** - порядок колонок не важен
- **Наследование данных** - поставщик и адрес наследуются от предыдущих строк
- **Валидация** - автоматическая проверка корректности данных
- **Скидки** - поддержка отображения цен со скидкой

## Сборка

### Требования:
- Qt 5.15+ или Qt 6.0+
- CMake 3.16+
- C++17 компилятор

### Сборка:
```bash
mkdir build
cd build
cmake ..
make
```

## Использование

1. **Загрузка файла**: Перетащите Excel файл в область загрузки или нажмите "Open Excel File"
2. **Просмотр данных**: Перейдите на вкладку "Preview" для просмотра загруженных данных
3. **Анализ статистики**: Вкладка "Statistics" показывает подробную статистику
4. **Генерация ценников**: Нажмите "Generate Price Tags" для создания документа

## Формат входного файла

Excel файл должен содержать заголовки колонок точно как указано в API. Пример:

| Поставщик | Адрес | Фирма | Категория | Пол | Цена | Цена 2 | Артикул |
|-----------|-------|-------|-----------|-----|------|--------|---------|
| ИП Иванов | Москва | FABRETTI | Сумка | жен | 4990 | 2540 | VFG0005-5 |
| | | FABRETTI | Сумка дорож | муж | 1590 | | VFF0009-3 |

## Архитектура проекта

### Основные компоненты:

1. **MainWindow** - главное окно с интерфейсом
   - Drag & Drop загрузка файлов
   - Вкладки: Main, Preview, Statistics
   - Управление процессом генерации

2. **ExcelParser** - парсер Excel файлов
   - Распаковка XLSX (ZIP архив)
   - Парсинг XML структуры
   - Гибкое определение колонок по заголовкам
   - Валидация данных

3. **PriceTag** - модель данных ценника
   - Все поля согласно API
   - Утилитарные методы для форматирования
   - Логика обработки скидок

4. **WordGenerator** - генератор документов
   - Создание таблицы ценников
   - Форматирование с разными стилями
   - Поддержка скидок и перечеркивания

### Преимущества архитектуры:

- **Модульность** - каждый компонент отвечает за свою область
- **Расширяемость** - легко добавить новые поля или форматы
- **Гибкость** - поддержка различных структур входных данных
- **Надежность** - валидация данных на всех этапах

## Сложность проекта

### Оценка сложности: **Средняя**

**Простые аспекты:**
- Базовый Qt GUI
- Стандартные алгоритмы парсинга
- Простая модель данных

**Сложные аспекты:**
- Парсинг сложной XML структуры Excel
- Гибкое определение колонок
- Логика наследования данных (поставщик/адрес)
- Форматирование документов с разными стилями
- Валидация и обработка ошибок

**Время разработки:** 2-4 недели для опытного разработчика

## Качество API

### Сильные стороны:
- ✅ **Гибкость** - порядок колонок не важен
- ✅ **Наследование** - умная логика для поставщика/адреса
- ✅ **Расширяемость** - легко добавить новые поля
- ✅ **Валидация** - проверка длины категории
- ✅ **Скидки** - поддержка цен со скидкой

### Области для улучшения:
- ⚠️ **Документация** - можно добавить больше примеров
- ⚠️ **Обработка ошибок** - более детальные сообщения об ошибках
- ⚠️ **Производительность** - оптимизация для больших файлов

## Планы развития

1. **Поддержка других форматов** - CSV, JSON
2. **Шаблоны ценников** - настраиваемые макеты
3. **Пакетная обработка** - несколько файлов одновременно
4. **Экспорт в PDF** - прямая генерация PDF
5. **База данных** - сохранение истории обработки
6. **Плагины** - расширяемая архитектура

## Лицензия

MIT License 